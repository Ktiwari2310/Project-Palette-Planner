<!DOCTYPE html>
<html class="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Create a New Project - Project Palette Planner</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

<script id="tailwind-config">
tailwind.config = {
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        "primary": "#8c8cf2",
        "background-light": "#f6f6f8",
        "background-dark": "#111121",
      },
      fontFamily: {
        "display": ["Inter", "sans-serif"]
      },
      borderRadius: {"DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px"},
    },
  },
}
</script>

<style>
.material-symbols-outlined {
  font-variation-settings:
  'FILL' 0,
  'wght' 400,
  'GRAD' 0,
  'opsz' 24
}
.material-symbols-outlined.fill {
  font-variation-settings:
  'FILL' 1
}
</style>
</head>

<body class="font-display bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-50">
<div class="relative flex min-h-screen w-full flex-row">
<main class="flex-1 p-8 sm:p-12">
<div class="mx-auto flex max-w-4xl flex-col gap-8">

<!-- Page Heading -->
<div>
  <h1 class="text-slate-900 dark:text-slate-50 text-4xl font-black leading-tight tracking-[-0.033em]">
    Create a New Project
  </h1>
  <p class="text-slate-500 dark:text-slate-400 mt-2">
    Fill in the details below to get your new project up and running.
  </p>
</div>

<!-- Form Container -->
<form class="flex flex-col gap-6">

  <!-- Project Title -->
  <label class="flex flex-col">
    <p class="text-base font-medium pb-2">Project Title</p>
    <input class="form-input rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800/50 p-4 h-14 focus:ring-2 focus:ring-primary/50" placeholder="e.g., Q4 Website Redesign" type="text" id="project-title"/>
  </label>

  <!-- Project Description -->
  <label class="flex flex-col">
    <p class="text-base font-medium pb-2">Project Description</p>
    <textarea class="form-input rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800/50 p-4 min-h-36 focus:ring-2 focus:ring-primary/50" placeholder="Briefly describe the project's main goals and target outcomes..." id="project-description"></textarea>
  </label>

  <!-- Project Manager -->
  <label class="flex flex-col relative">
    <p class="text-base font-medium pb-2">Project Manager</p>
    <select class="form-select rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800/50 p-4 h-14 appearance-none focus:ring-2 focus:ring-primary/50" id="project-manager">
      <option>Select a team member</option>
      <option>Khushboo Tiwari</option>
      <option>Fuzail Khan</option>
      <option>Rishika Singh</option>
      <option>Arwa Vasaiwala</option>
      <option>Manini Utekar</option>
    </select>
    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-slate-500 dark:text-slate-400">
      <span class="material-symbols-outlined">expand_more</span>
    </div>
  </label>

  <!-- Start Date -->
  <div>
    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2" for="start-date">Start Date</label>
    <div class="relative">
      <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
        <span class="material-symbols-outlined text-slate-400 dark:text-slate-500">event</span>
      </div>
      <input class="block w-full rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 pl-10" id="start-date" type="date"/>
    </div>
  </div>

    <!-- End Date (Auto/Manual) -->
<div>
  <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2" for="due-date">End Date</label>
  <div class="relative">
    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
      <span class="material-symbols-outlined text-slate-400 dark:text-slate-500">calendar_today</span>
    </div>
    <input class="block w-full rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 shadow-sm pl-10" 
           id="due-date" 
           type="date" 
           placeholder="Auto calculated or enter manually"/>
  </div>
  <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">You can manually override the end date if needed.</p>
</div>

  <!-- Project Duration (Weeks) -->
  <div>
    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2" for="project-weeks">Project Duration (in Weeks)</label>
    <div class="relative">
      <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
        <span class="material-symbols-outlined text-slate-400 dark:text-slate-500">schedule</span>
      </div>
      <input class="block w-full rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 pl-10 placeholder-slate-400 dark:placeholder-slate-500" id="project-weeks" type="number" min="1" placeholder="e.g., 8"/>
    </div>
  </div>



  <!-- Team Members -->
  <div>
    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2" for="team-members">Number of Team Members</label>
    <div class="relative">
      <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
        <span class="material-symbols-outlined text-slate-400 dark:text-slate-500">group</span>
      </div>
      <input class="block w-full rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 pl-10" id="team-members" type="number" min="1" placeholder="e.g., 5"/>
    </div>
  </div>

  <!-- Project Phases -->
  <div>
    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Project Phases</label>
    <div class="space-y-2" id="phases-container">
      <div id="phases-list"></div>
      <div class="flex items-center space-x-2 pt-2">
        <input id="new-phase-input" class="flex-grow block w-full rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50" placeholder="Add a new phase..." type="text"/>
        <button id="add-phase-btn" class="flex items-center justify-center px-4 py-2.5 border border-slate-300 dark:border-slate-600 text-sm font-medium rounded text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-primary" type="button">
          <span class="material-symbols-outlined text-base mr-2">add</span>
          Add Phase
        </button>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="flex items-center justify-end space-x-4 pt-4 border-t border-slate-200 dark:border-slate-800">
    <button type="button" class="h-12 px-6 text-sm font-semibold text-slate-600 dark:text-slate-300 rounded hover:bg-slate-200 dark:hover:bg-slate-700">
      Cancel
    </button>
    <button type="submit" class="h-12 px-6 text-sm font-semibold text-white bg-primary rounded shadow-sm hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
      Create Project
    </button>
  </div>

</form>
</div>
</main>
</div>

<script>
// Automatically calculate End Date
const startDateInput = document.getElementById('start-date');
const weeksInput = document.getElementById('project-weeks');
const dueDateInput = document.getElementById('due-date');

// Calculate End Date from Start Date + Weeks
function updateEndDateFromWeeks() {
  const startDate = startDateInput.value;
  const weeks = parseInt(weeksInput.value);

  if (startDate && weeks > 0 && !dueDateInput.dataset.manual) {
    const start = new Date(startDate);
    const end = new Date(start);
    end.setDate(start.getDate() + weeks * 7);
    dueDateInput.value = end.toISOString().split('T')[0];
  }
}

// Calculate Weeks from Start Date + End Date
function updateWeeksFromEndDate() {
  const startDate = startDateInput.value;
  const endDate = dueDateInput.value;

  if (startDate && endDate) {
    const start = new Date(startDate);
    const end = new Date(endDate);
    const diffDays = Math.round((end - start) / (1000 * 60 * 60 * 24));
    const calculatedWeeks = Math.ceil(diffDays / 7);
    weeksInput.value = calculatedWeeks > 0 ? calculatedWeeks : 1;
  }
}

// Event listeners
startDateInput.addEventListener('change', () => {
  dueDateInput.dataset.manual ? updateWeeksFromEndDate() : updateEndDateFromWeeks();
});

weeksInput.addEventListener('input', () => {
  dueDateInput.dataset.manual ? updateWeeksFromEndDate() : updateEndDateFromWeeks();
});

// User manually edits End Date
dueDateInput.addEventListener('input', () => {
  dueDateInput.dataset.manual = true;
  updateWeeksFromEndDate();
});


// Handle Form Submit
document.querySelector('form').addEventListener('submit', function (e) {
  e.preventDefault();

  const title = document.getElementById('project-title').value.trim();
  const description = document.getElementById('project-description').value.trim();
  const manager = document.getElementById('project-manager').value.trim();
  const startDate = startDateInput.value.trim();
  const dueDate = dueDateInput.value.trim();
  const team = document.getElementById('team-members').value.trim();
  const weeks = weeksInput.value.trim();

  if (!title || !description || manager === "Select a team member" || !startDate || !dueDate || !team || !weeks) {
    alert("Please fill in all fields before creating the project.");
    return;
  }

  const newProject = { 
    title, 
    description, 
    manager, 
    startDate, 
    dueDate, 
    weeks, 
    team, 
    status: "Not Started", 
    progress: 0 
  };

  let projects = JSON.parse(localStorage.getItem("projects")) || [];
  projects.push(newProject);
  localStorage.setItem("projects", JSON.stringify(projects));

  window.location.href = "dashboard.html";
});

// Dynamic Phases
const phasesContainer = document.getElementById('phases-container');
const addPhaseBtn = document.getElementById('add-phase-btn');
const newPhaseInput = document.getElementById('new-phase-input');

function createPhaseElement(name) {
  const div = document.createElement('div');
  div.className = 'flex items-center space-x-2 p-3 rounded bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600';
  
  const dragIcon = document.createElement('span');
  dragIcon.className = 'material-symbols-outlined cursor-grab text-slate-400 dark:text-slate-500';
  dragIcon.textContent = 'drag_indicator';
  
  const input = document.createElement('input');
  input.className = 'flex-grow bg-transparent border-none text-slate-800 dark:text-slate-200 text-sm focus:outline-none';
  input.value = name;

  const deleteBtn = document.createElement('button');
  deleteBtn.type = 'button';
  deleteBtn.className = 'text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300';
  deleteBtn.innerHTML = '<span class="material-symbols-outlined" style="font-size:20px;">close</span>';
  deleteBtn.addEventListener('click', () => div.remove());

  div.appendChild(dragIcon);
  div.appendChild(input);
  div.appendChild(deleteBtn);

  return div;
}

addPhaseBtn.addEventListener('click', () => {
  const name = newPhaseInput.value.trim();
  if (!name) return;
  const phaseEl = createPhaseElement(name);
  phasesContainer.insertBefore(phaseEl, newPhaseInput.parentElement);
  newPhaseInput.value = '';
});
</script>

</body>
</html>
